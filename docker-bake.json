{
    "variable": {
        "PRODUCT_NAME": {},
        "REPO_NAME": {},
        "VERSION": {},
        "CHANNEL": {},
        "DEPS_ID": {}
    },
    "group": {
        "production": {
            "targets": [
                "web-production",
                "server-production"
            ]
        }
    },
    "target": {
        "common": {
            "args": {
                "PUBLIC_VERSION": "${VERSION}",
                "PUBLIC_PRODUCT_NAME": "${PRODUCT_NAME}",
                "PUBLIC_REPO_NAME": "${REPO_NAME}",
                "PUBLIC_ENV": "${ENV}"
            },
            "platforms": [
                "linux/amd64"
            ],
            "labels": {
                "org.opencontainers.image.source": "https://github.com/faxaq/${REPO_NAME}",
                "org.opencontainers.image.licenses": "MIT"
            },
            "cache-from": [
                "type=gha,scope=${DEPS_ID}"
            ],
            "cache-to": [
                "type=gha,mode=max,scope=${DEPS_ID}"
            ]
        },
        "web": {
            "inherits": [
                "common"
            ],
            "matrix": {
                "ENV": [
                    "production"
                ]
            },
            "Dockerfile": "Dockerfile",
            "name": "web-${ENV}",
            "tags": [
                "ghcr.io/faxaq/${PRODUCT_NAME}_web:${VERSION}-${ENV}",
                "ghcr.io/faxaq/${PRODUCT_NAME}_web:${CHANNEL}-${ENV}"
            ],
            "labels": {
                "org.opencontainers.image.description": "web"
            },
            "target": "web"
        },
        "server": {
            "inherits": [
                "common"
            ],
            "matrix": {
                "ENV": [
                    "production"
                ]
            },
            "Dockerfile": "Dockerfile",
            "name": "server-${ENV}",
            "tags": [
                "ghcr.io/faxaq/${PRODUCT_NAME}_server:${VERSION}-${ENV}",
                "ghcr.io/faxaq/${PRODUCT_NAME}_server:${CHANNEL}-${ENV}"
            ],
            "labels": {
                "org.opencontainers.image.description": "server"
            },
            "target": "server"
        }
    }
}